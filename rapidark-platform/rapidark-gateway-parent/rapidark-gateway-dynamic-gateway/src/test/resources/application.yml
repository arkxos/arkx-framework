# 本地服务访问，注：当前网关服务IP，做为代理路由IP提供给第三方请求。
# 请求方式：http://gateway_server_ip:8771/path
# 请求流程：外部服务---请求---》网关服务---转发---》后台服务
server:
  # 服务端口
  port: 8771
  # 服务IP
  address: 0.0.0.0

spring:
  application:
    # 应用服务名
    name: dynamic-gateway
#  profiles:
#    active: cloud,db
  config:
    # 在升级到springcloud-2021.0.1.x后spring-cloud-starter-alibaba-nacos-config模块移除了spring-cloud-starter-bootstrap依赖
    import:
      # 缺少bootstrap依赖导致bootstarp.yml不会在进行加载，需要通过spring.config.import=optional:nacos: instead.加载nacos中心的指定dataId属性
      - optional:nacos:${spring.cloud.nacos.config.prefix}.${spring.cloud.nacos.config.file-extension}
      - optional:classpath:application-cloud.yml
      - optional:classpath:application-db.yml
  cloud:
    # 注册到nacos，服务注册发现和配置管理中心
    nacos:
      username: nacos
      password: nacos
      config:
        server-addr: 127.0.0.1:8848
        # 注意：管理模块和网关模块均采用统一的配置管理名称（dataId）和默认DEFAULT_GROUP组（group）
        group: DEFAULT_GROUP
        # 配置内容格式
        file-extension: properties
        # dataId名称，程序注册事件监听此dataId下的配置变化
        prefix: flying-fish-gateway
        # 指定命名空间（可以不指定）
        # namespace: my_namespace_id
      discovery:
        server-addr: 127.0.0.1:8848
        # 指定命名空间（可以不指定）
        # namespace: my_namespace_id
        # false只获取服务，不注册当前服务; 默认为true
        # register-enabled: false


# 启用服务健康检测，注册中心将通过http://host:port/actuator/health 检测服务的存活，默认10s一次
# 查看网关的路由：http://localhost:8888/actuator/gateway/routes
management:
  endpoints:
    web:
      exposure:
        include:
        # 开放所有端点health，info，metrics，通过actuator/+端点名就可以获取相应的信息。开发用*，上生产请取消。默认打开health和info
        - "*"
  health:
    # 开启后打印详细信息
    show-details: always
    refresh:
      enabled: true

# 配置日志
logging:
  config: classpath:log4j2.xml
  level:
    # log 级别
    org.springframework.cloud.gateway: debug

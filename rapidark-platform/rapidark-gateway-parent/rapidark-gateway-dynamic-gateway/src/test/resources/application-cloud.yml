
spring:
  cloud:
    loadbalancer:
      ribbon:
        enabled: false
    gateway:
      discovery:
        locator:
          # 启用本地化网关
          enabled: true
          # 将服务名转换为小写
          lower-case-service-id: true
      # 网关跨域配置
      globalcors:
        corsConfigurations:
          '[/**]':
            allowedOrigins: "*"
            allowedMethods:
            - GET
            - POST
            - DELETE
            - PUT
      # 路由示例（routes：路由，它由唯一标识（ID）、目标服务地址（uri）、一组断言（predicates）和一组过滤器组成（filters），filters 不是必需参数）
      routes:
      - id: custom-uri-id
        # 转发到指定url
        uri: http://127.0.0.1:8769
        predicates:
        #- After=2017-01-20T17:42:47.789-07:00[America/Denver]
        # 只限GET请求
        - Method=GET
        # 路径断言匹配,最新转发到：uri + path
        # 如：http://127.0.0.1:8771/custom/userCenter/info 转发指向：http://127.0.0.1:8769/custom/userCenter/info
        - Path=/custom/userCenter/**
        # 请求头Headers中的Host主机匹配
        - Host=mytest.com
        # 请求头Headers中的远程请求IP地址匹配,符合IPv4格式
        - RemoteAddr=192.168.11.1/24
        filters:
        # 开启相应过滤服务，注意SecureClientId对应SecureClientIdGatewayFilterFactory，GatewayFilterFactory为默认固定后缀,gateway只匹配前缀
        - SecureClientId=false
        - SecureIp=false
        - SecureToken=false
        # true则开启认证，false则不开启；指向AuthorizeGatewayFilterFactory
        - Authorize=false
        # StripPrefix=1表示过滤Path第一段（截取/test）
        # 如：http://127.0.0.1:8769/custom/userCenter/info 转发指向: http://127.0.0.1:8769/userCenter/info
        - StripPrefix=1
        # 在转发url后加参数version=test1
        - AddRequestParameter=version,test
        # 重写Path转发请求地址,YAML规范限制$\用来代替$
        # 接口测试示例：examples/provider-example/com/flying/fish/example/rest/ProducerController
        # 如：http://127.0.0.1:8769/userCenter/info 重写指向 http://127.0.0.1:8769/producer/info
        - RewritePath=/userCenter/(?<segment>.*), /producer/$\{segment}
        # 添加请求大小限制
        - name: RequestSize
          args:
            # 限制请求大小为5000kb（不设置默认为5M），超过返回状态码413，参见：RequestSizeGatewayFilterFactory
            maxSize: 5000000
        # 添加结果缓存
        - name: CacheResult
          args:
            # ttl=10表示时长(秒/s)
            ttl: 10
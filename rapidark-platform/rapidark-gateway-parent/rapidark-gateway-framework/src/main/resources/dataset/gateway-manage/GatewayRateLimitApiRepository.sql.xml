<?xml version="1.0" encoding="utf-8"?>
<sqltoy xmlns="http://www.sagframe.com/schema/sqltoy"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.sagframe.com/schema/sqltoy http://www.sagframe.com/schema/sqltoy/sqltoy.xsd">

    <!-- 查询当前网关路由服务下已注册的客户端 -->
    <sql id="GatewayRateLimitApiRepository_selectRateLimitApi">
        <value>
            <![CDATA[
          SELECT
            i.policy_id,
            p.limit_quota,
            p.interval_unit,
            p.policy_name,
            a.api_id,
            a.api_code,
            a.api_name,
            a.api_category,
            a.service_id,
            a.path,
            r.uri
        FROM gateway_rate_limit_api i
        INNER JOIN gateway_rate_limit p ON i.policy_id = p.policy_id
        INNER JOIN base_api a ON i.api_id = a.api_id
        INNER JOIN gateway_app_route r ON a.service_id = r.system_code
        WHERE p.policy_type = 'url'
            ]]>
        </value>
    </sql>


</sqltoy>